groups:
  - name: Application Configuration
    description: Application Configuration
  - name: Container Image
    description: Image to be used for container
  - name: Networking
    description: Networking Configuration
  - name: Database
    description: Database Configuration

portals:
  open:
    protocols:
      - "http"
    host:
      - "$node_ip"
    ports:
      - "$variable-gomp.service.port"

questions:
  - variable: gomp
    label: "Application Configuration"
    group: Application Configuration
    schema:
      type: dict
      attrs:
        - variable: image
          label: "Container Image"
          group: Container Image
          schema:
            type: dict
            attrs:
              - variable: tag
                label: "Override Container Image Tag"
                group: Container Image
                schema:
                  type: string
                  default: ""
        - variable: service
          label: "Main Service"
          group: Networking
          schema:
            type: dict
            attrs:
              - variable: port
                label: "Web Port"
                schema:
                  type: int
                  min: 3000
                  max: 65535
                  default: 5000
                  required: true
        - variable: postgresql
          label: "PostgreSQL"
          group: Database
          schema:
            type: dict
            attrs:
            - variable: enabled
              label: "Enabled"
              schema:
                type: boolean
                default: false