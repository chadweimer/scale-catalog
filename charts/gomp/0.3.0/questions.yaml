groups:
  - name: Configuration
    description: Configuration

portals:
  open:
    protocols:
      - "http"
    host:
      - "$node_ip"
    ports:
      - "$variable-gomp.service.nodePort"

questions:
  - variable: gomp
    label: Application Configuration
    group: Configuration
    schema:
      type: dict
      attrs:
        - variable: image
          label: Container Image
          schema:
            type: dict
            attrs:
              - variable: tag
                label: Override Tag
                schema:
                  type: string
                  default: ""
        - variable: service
          label: Main Service
          schema:
            type: dict
            attrs:
              - variable: nodePort
                label: Web Port
                schema:
                  type: int
                  min: 8000
                  max: 65535
                  default: 15000
                  required: true
        - variable: persistence
          label: Storage
          schema:
            type: dict
            attrs:
              - variable: data
                label: Application Data
                schema:
                  type: dict
                  attrs:
                    - variable: type
                      label: Type of Storage
                      description: Sets the persistence type
                      schema:
                        type: string
                        default: pvc
                        enum:
                          - value: pvc
                            description: PVC
                          - value: hostPath
                            description: Host Path
                    - variable: hostPath
                      label: Host Path
                      description: Select the host path
                      schema:
                        type: hostpath
                        show_if: [["type", "=", "hostPath"]]
        - variable: postgresql
          label: PostgreSQL
          schema:
            type: dict
            attrs:
            - variable: enabled
              label: Enabled
              schema:
                type: boolean
                default: false
                show_subquestions_if: true
                subquestions:
                  - variable: auth
                    label: Authentication
                    schema:
                      type: dict
                      attrs:
                        - variable: password
                          label: Database Password
                          schema:
                            type: string
                            default: ""
                            required: true